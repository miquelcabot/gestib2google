webpackJsonp([1],{XwoO:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("fZjL"),a=n.n(o),r=n("t4zo"),s=n("fgoS"),i=n("QmSG"),c={name:"Csv",data:function(){return{group:"",onlyteachers:!1,errors:[],loading:!1,groupsStudents:[]}},mounted:function(){this.groupsStudents=JSON.parse(sessionStorage.groupsStudents)},methods:{csv:function(){var e=this;this.loading=!0,Object(s.b)(null,function(t,n){if(t)e.errors.push('Error llegint usuaris "'+t.message+'"');else{var o=[];a()(n).forEach(function(t){if(!n[t].suspended&&(!e.onlyteachers||n[t].teacher)&&(!e.group||n[t].groups.includes(e.group))){var a="";n[t].teacher?a="Professorat":n[t].groups.forEach(function(e){e.includes(Object(i.a)().groupPrefixStudents)&&(a=e.substr(Object(i.a)().groupPrefixStudents.length))}),a&&o.push([n[t].surname,n[t].name,n[t].domainemail,a])}}),o.sort(function(e,t){return e[0]<t[0]?-1:1});var s="domainusers"+(new Date).toLocaleString()+".csv",c=o.map(function(e){return e.join(",")}).join("\r\n"),l=new Blob([c],{type:"data:text/csv;charset=utf-8"});Object(r.saveAs)(l,s)}e.loading=!1})}}},l=n("XyMi");var u=function(e){n("z0q+")},d=Object(l.a)(c,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"card shadow mb-4"},[e._m(0),e._v(" "),n("div",{staticClass:"card-body"},[n("form",{on:{submit:function(e){e.preventDefault()}}},[n("div",{staticClass:"form-group"},[n("label",{staticClass:"col-sm col-form-label",attrs:{for:"groupsdomainuserscsv"}},[e._v("Grup d'alumnes")]),e._v(" "),n("div",{staticClass:"col-sm-10"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.group,expression:"group"}],staticClass:"form-control",attrs:{id:"group",name:"group",disabled:e.loading},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.group=t.target.multiple?n:n[0]}}},[n("option",{attrs:{value:""}},[e._v("Tots")]),e._v(" "),e._l(e.groupsStudents,function(t){return n("option",{key:t.email,domProps:{value:t.email}},[e._v("\n                "+e._s(t.nameWithEmail)+"\n              ")])})],2)])]),e._v(" "),n("div",{staticClass:"form-group"},[n("div",{staticClass:"form-check"},[n("label",{staticClass:"form-check-label"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.onlyteachers,expression:"onlyteachers"}],staticClass:"form-check-input",attrs:{id:"onlyteachers",name:"onlyteachers",type:"checkbox",disabled:e.loading},domProps:{checked:Array.isArray(e.onlyteachers)?e._i(e.onlyteachers,null)>-1:e.onlyteachers},on:{change:function(t){var n=e.onlyteachers,o=t.target,a=!!o.checked;if(Array.isArray(n)){var r=e._i(n,null);o.checked?r<0&&(e.onlyteachers=n.concat([null])):r>-1&&(e.onlyteachers=n.slice(0,r).concat(n.slice(r+1)))}else e.onlyteachers=a}}}),e._v(" Només professorat")])])]),e._v(" "),n("div",{staticClass:"form-group"},[n("button",{staticClass:"btn btn-primary",attrs:{disabled:e.loading},on:{click:function(t){return e.csv()}}},[e.loading?n("span",{staticClass:"spinner-border spinner-border-sm"}):e._e(),e._v("\n            "+e._s(e.loading?"Exportant ...":"Exportar")+"\n          ")])])])])]),e._v(" "),e._l(e.errors,function(t,o){return n("div",{key:o,staticClass:"alert alert-danger alert-dismissible fade show",attrs:{role:"alert"}},[n("strong",[e._v("ERROR: ")]),e._v(e._s(t)+"\n    "),e._m(1,!0)])})],2)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"card-header py-3"},[t("h6",{staticClass:"m-0 font-weight-bold text-primary"},[this._v("Exportar a CSV")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"alert","aria-label":"Close"}},[t("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])}],!1,u,null,null);t.default=d.exports},t4zo:function(e,t,n){(function(n){var o,a,r;a=[],void 0===(r="function"==typeof(o=function(){"use strict";function t(e,t,n){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){i(o.response,t,n)},o.onerror=function(){console.error("could not download file")},o.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,s=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),i=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,n,s){var i=r.URL||r.webkitURL,c=document.createElement("a");n=n||e.name||"download",c.download=n,c.rel="noopener","string"==typeof e?(c.href=e,c.origin===location.origin?a(c):o(c.href)?t(e,n,s):a(c,c.target="_blank")):(c.href=i.createObjectURL(e),setTimeout(function(){i.revokeObjectURL(c.href)},4e4),setTimeout(function(){a(c)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,r){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,r),n);else if(o(e))t(e,n,r);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout(function(){a(s)})}}:function(e,n,o,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,o);var i="application/octet-stream"===e.type,c=/constructor/i.test(r.HTMLElement)||r.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||i&&c||s)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},u.readAsDataURL(e)}else{var d=r.URL||r.webkitURL,f=d.createObjectURL(e);a?a.location=f:location.href=f,a=null,setTimeout(function(){d.revokeObjectURL(f)},4e4)}});r.saveAs=i.saveAs=i,void 0!==e&&(e.exports=i)})?o.apply(t,a):o)||(e.exports=r)}).call(t,n("DuR2"))},"z0q+":function(e,t){}});
//# sourceMappingURL=1.98e8c8de74f921d01de7.js.map