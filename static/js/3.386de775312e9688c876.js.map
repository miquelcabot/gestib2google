{"version":3,"sources":["webpack:///src/views/Spreadsheet.vue","webpack:///./src/views/Spreadsheet.vue","webpack:///./src/views/Spreadsheet.vue?05c0"],"names":["Spreadsheet","name","data","group","onlyteachers","errors","loading","groupsStudents","filename","mounted","this","JSON","parse","sessionStorage","methods","spreadsheet","_this","Object","DomainRead","err","users","push","message","sheetUsers","keys_default","forEach","user","suspended","teacher","groups","includes","surname","domainemail","config","groupPrefixStudents","sheetUsersOrdered","sort","key","Date","toLocaleString","Oauth2Client","spreadsheets","create","resource","properties","title","fields","spreadsheetId","addSheet","$bvModal","show","index","callback","_this2","length","a","b","toString","localeCompare","unshift","batchUpdate","requests","response","deleteSheet","sheetId","values","update","range","valueInputOption","__vue_styles__","context","__webpack_require__","Component","component_normalizer","_vm","_h","$createElement","_c","_self","staticClass","_m","_v","on","submit","$event","preventDefault","attrs","for","directives","rawName","value","expression","id","disabled","change","$$selectedVal","Array","prototype","filter","call","target","options","o","selected","map","_value","multiple","_l","email","domProps","_s","nameWithEmail","type","checked","isArray","_i","$$a","$$el","$$c","$$i","concat","slice","click","_e","error","role","ok-only","href","data-dismiss","aria-label","aria-hidden","__webpack_exports__"],"mappings":"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","file":"static/js/3.386de775312e9688c876.js","sourcesContent":["<template>\n  <div>\n    <!-- Form full de càlcul -->\n    <div class=\"card shadow mb-4\">\n      <div class=\"card-header py-3\">\n          <h6 class=\"m-0 font-weight-bold text-primary\">Exportar a un full de càlcul</h6>\n      </div>\n      <div class=\"card-body\">\n        <div class=\"alert alert-warning\" role=\"alert\">\n          ATENCIÓ: No es poden exportar més de 30 grups, degut a que hi ha un límit de 60 escriptures\n          als fulls de càlcul de Google per minut. Ho podeu consultar a\n          <a href=\"https://developers.google.com/analytics/devguides/config/mgmt/v3/limits-quotas\">\"Límites y cuotas en las solicitudes a API\"</a> i a\n          <a href=\"https://developers.google.com/sheets/api/limits\">\"Usage Limits\"</a>\n        </div>\n        <form @submit.prevent>\n          <div class=\"form-group\">\n            <label for=\"groupsdomainuserscsv\" class=\"col-sm col-form-label\">Grup d'alumnes</label>\n            <div class=\"col-sm-10\">\n              <select class=\"form-control\" id=\"group\" name=\"group\" v-model=\"group\" :disabled=\"loading\">\n                <option value=\"\">Tots</option>\n                <option v-for=\"group in groupsStudents\" v-bind:key=\"group.email\" v-bind:value=\"group.email\">\n                  {{ group.nameWithEmail }}\n                </option>\n              </select>\n            </div>\n          </div>\n          <div class=\"form-group\">\n            <div class=\"form-check\">\n              <label class=\"form-check-label\">\n              <input class=\"form-check-input\" id=\"onlyteachers\" name=\"onlyteachers\" type=\"checkbox\" v-model=\"onlyteachers\" :disabled=\"loading\"> Només professorat</label>\n            </div>\n          </div>\n          <div class=\"form-group\">\n            <button class=\"btn btn-primary\" v-on:click=\"spreadsheet()\" :disabled=\"loading\">\n              <span v-if=\"loading\" class=\"spinner-border spinner-border-sm\"></span>\n              {{ loading ? 'Exportant ...' : 'Exportar' }}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n    <!-- Fi form full de càlcul -->\n    <div class=\"alert alert-danger alert-dismissible fade show\" role=\"alert\" v-for=\"(error, index) in errors\" v-bind:key=\"index\">\n      <strong>ERROR: </strong>{{error}}\n      <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">\n        <span aria-hidden=\"true\">&times;</span>\n      </button>\n    </div>\n    <b-modal id=\"modal-ok\" title=\"GestIB2Google\" ok-only>\n      <p class=\"my-4\">Procés finalitzat!<br>Fitxer guardat a 'La meva unitat' de Google Drive amb el nom '{{ filename }}'.</p>\n    </b-modal>\n  </div>\n</template>\n\n<script>\nimport {getDomainUsers} from '@/api/DomainRead'\nimport {oauth2ClientServiceSheets} from '@/api/Oauth2Client'\nimport {config} from '@/config'\n\nexport default {\n  name: 'Spreadsheet',\n  data () {\n    return {\n      group: '',\n      onlyteachers: false,\n      errors: [],\n      loading: false,\n      groupsStudents: [],\n      filename: ''\n    }\n  },\n  mounted () {\n    this.groupsStudents = JSON.parse(sessionStorage.groupsStudents)\n  },\n  methods: {\n    spreadsheet () {\n      this.loading = true\n      getDomainUsers(null, (err, users) => {\n        if (err) {\n          this.errors.push('Error llegint usuaris \"' + err.message + '\"')\n          this.loading = false\n        } else {\n          // Array amb informació a exportar al full de càlcul\n          let sheetUsers = []\n          // Per cada usuari del domini...\n          Object.keys(users).forEach(user => {\n            if (!users[user].suspended) {\n              if (!this.onlyteachers || users[user].teacher) {\n                if (!this.group || users[user].groups.includes(this.group)) {\n                  // Grup professorat\n                  if (users[user].teacher) {\n                    if (!sheetUsers['Professorat']) {\n                      sheetUsers['Professorat'] = []\n                    }\n                    sheetUsers['Professorat'].push([\n                      users[user].surname + ', ' + users[user].name,\n                      users[user].domainemail]\n                    )\n                  }\n                  // Grups alumnes\n                  users[user].groups.forEach(group => {\n                    if (group.includes(config().groupPrefixStudents)) {\n                      if (!sheetUsers[group]) {\n                        sheetUsers[group] = []\n                      }\n                      sheetUsers[group].push([\n                        users[user].surname + ', ' + users[user].name,\n                        users[user].domainemail]\n                      )\n                    }\n                  })\n                }\n              }\n            }\n          })\n          // Ordenam per grup\n          let sheetUsersOrdered = []\n          Object.keys(sheetUsers).sort().forEach(key => {\n            sheetUsersOrdered[key] = sheetUsers[key]\n          })\n\n          this.filename = 'Usuaris domini ' + (new Date()).toLocaleString()\n          // Cream el full de càlcul a Google Drive\n          // https://developers.google.com/sheets/api/guides/create#nodejs\n          oauth2ClientServiceSheets().spreadsheets.create({\n            resource: {\n              properties: {\n                title: this.filename\n              }\n            },\n            fields: 'spreadsheetId'\n          }, (err, spreadsheet) => {\n            if (err) {\n              this.errors.push('Error creant el full de càlcul \"' + err.message + '\"')\n              this.loading = false\n            } else {\n              // Si s'ha creat correctament el full de càlcul...\n              let spreadsheetId = spreadsheet.data.spreadsheetId\n              this.addSheet(spreadsheetId, sheetUsersOrdered, 0, () => {\n                this.loading = false\n                this.$bvModal.show('modal-ok')\n              })\n            }\n          })\n        }\n      })\n    },\n    addSheet (spreadsheetId, sheetUsersOrdered, index, callback) {\n      let groups = Object.keys(sheetUsersOrdered)\n      if (index >= groups.length) {\n        // Hem arribat al final de l'array. Tornar\n        callback()\n      } else {\n        // Per cada grup...\n        let group = groups[index]\n\n        // Ordenam alfabèticament els membres del grup\n        sheetUsersOrdered[group].sort((a, b) => a.toString().localeCompare(b))\n        // Afegim capçalera\n        sheetUsersOrdered[group].unshift(['Nom', 'Email'])\n\n        // Afegim un nou full per cada grup\n        oauth2ClientServiceSheets().spreadsheets.batchUpdate({\n          spreadsheetId: spreadsheetId,\n          resource: {\n            requests: {\n              addSheet: {\n                properties: {\n                  title: group\n                }\n              }\n            }\n          }\n        }, (err, response) => {\n          if (err) {\n            this.errors.push('Error afegint el grup \"' + group + '\" al full de càlcul \"' + err.message + '\"')\n            this.loading = false\n          } else {\n            // En acabar d'afegir el primer grup, eliminar el primer full\n            if (index === 0) {\n              oauth2ClientServiceSheets().spreadsheets.batchUpdate({\n                spreadsheetId,\n                resource: {\n                  requests: {\n                    deleteSheet: {\n                      sheetId: 0\n                    }\n                  }\n                }\n              }, (err) => {\n                if (err) {\n                  this.errors.push('Error esborrant les pàgines buides del full de càlcul \"' + err.message + '\"')\n                  this.loading = false\n                }\n              })\n            }\n\n            // Afegim valors (membres del grup) al full\n            oauth2ClientServiceSheets().spreadsheets.values.update({\n              spreadsheetId: spreadsheetId,\n              range: group + '!A1',\n              valueInputOption: 'USER_ENTERED',\n              resource: {\n                values: sheetUsersOrdered[group]\n              }\n            }, (err, response) => {\n              if (err) {\n                this.errors.push('Error afegint les dades del grup \"' + group + '\" al full de càlcul \"' + err.message + '\"')\n                this.loading = false\n              } else {\n                // Cridam recursivament el següent grup\n                this.addSheet(spreadsheetId, sheetUsersOrdered, index + 1, callback)\n              }\n            })\n          }\n        })\n      }\n    }\n  }\n}\n</script>\n\n<style>\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/Spreadsheet.vue","function injectStyle (context) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"scoped\\\":false,\\\"sourceMap\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Spreadsheet.vue\")\n}\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Spreadsheet.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Spreadsheet.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6bbaa9e2\\\",\\\"hasScoped\\\":false,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Spreadsheet.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../../node_modules/vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/Spreadsheet.vue\n// module id = null\n// module chunks = ","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"card shadow mb-4\"},[_vm._m(0),_vm._v(\" \"),_c('div',{staticClass:\"card-body\"},[_vm._m(1),_vm._v(\" \"),_c('form',{on:{\"submit\":function($event){$event.preventDefault();}}},[_c('div',{staticClass:\"form-group\"},[_c('label',{staticClass:\"col-sm col-form-label\",attrs:{\"for\":\"groupsdomainuserscsv\"}},[_vm._v(\"Grup d'alumnes\")]),_vm._v(\" \"),_c('div',{staticClass:\"col-sm-10\"},[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.group),expression:\"group\"}],staticClass:\"form-control\",attrs:{\"id\":\"group\",\"name\":\"group\",\"disabled\":_vm.loading},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.group=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_c('option',{attrs:{\"value\":\"\"}},[_vm._v(\"Tots\")]),_vm._v(\" \"),_vm._l((_vm.groupsStudents),function(group){return _c('option',{key:group.email,domProps:{\"value\":group.email}},[_vm._v(\"\\n                \"+_vm._s(group.nameWithEmail)+\"\\n              \")])})],2)])]),_vm._v(\" \"),_c('div',{staticClass:\"form-group\"},[_c('div',{staticClass:\"form-check\"},[_c('label',{staticClass:\"form-check-label\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.onlyteachers),expression:\"onlyteachers\"}],staticClass:\"form-check-input\",attrs:{\"id\":\"onlyteachers\",\"name\":\"onlyteachers\",\"type\":\"checkbox\",\"disabled\":_vm.loading},domProps:{\"checked\":Array.isArray(_vm.onlyteachers)?_vm._i(_vm.onlyteachers,null)>-1:(_vm.onlyteachers)},on:{\"change\":function($event){var $$a=_vm.onlyteachers,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.onlyteachers=$$a.concat([$$v]))}else{$$i>-1&&(_vm.onlyteachers=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.onlyteachers=$$c}}}}),_vm._v(\" Només professorat\")])])]),_vm._v(\" \"),_c('div',{staticClass:\"form-group\"},[_c('button',{staticClass:\"btn btn-primary\",attrs:{\"disabled\":_vm.loading},on:{\"click\":function($event){return _vm.spreadsheet()}}},[(_vm.loading)?_c('span',{staticClass:\"spinner-border spinner-border-sm\"}):_vm._e(),_vm._v(\"\\n            \"+_vm._s(_vm.loading ? 'Exportant ...' : 'Exportar')+\"\\n          \")])])])])]),_vm._v(\" \"),_vm._l((_vm.errors),function(error,index){return _c('div',{key:index,staticClass:\"alert alert-danger alert-dismissible fade show\",attrs:{\"role\":\"alert\"}},[_c('strong',[_vm._v(\"ERROR: \")]),_vm._v(_vm._s(error)+\"\\n    \"),_vm._m(2,true)])}),_vm._v(\" \"),_c('b-modal',{attrs:{\"id\":\"modal-ok\",\"title\":\"GestIB2Google\",\"ok-only\":\"\"}},[_c('p',{staticClass:\"my-4\"},[_vm._v(\"Procés finalitzat!\"),_c('br'),_vm._v(\"Fitxer guardat a 'La meva unitat' de Google Drive amb el nom '\"+_vm._s(_vm.filename)+\"'.\")])])],2)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"card-header py-3\"},[_c('h6',{staticClass:\"m-0 font-weight-bold text-primary\"},[_vm._v(\"Exportar a un full de càlcul\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"alert alert-warning\",attrs:{\"role\":\"alert\"}},[_vm._v(\"\\n        ATENCIÓ: No es poden exportar més de 30 grups, degut a que hi ha un límit de 60 escriptures\\n        als fulls de càlcul de Google per minut. Ho podeu consultar a\\n        \"),_c('a',{attrs:{\"href\":\"https://developers.google.com/analytics/devguides/config/mgmt/v3/limits-quotas\"}},[_vm._v(\"\\\"Límites y cuotas en las solicitudes a API\\\"\")]),_vm._v(\" i a\\n        \"),_c('a',{attrs:{\"href\":\"https://developers.google.com/sheets/api/limits\"}},[_vm._v(\"\\\"Usage Limits\\\"\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',{staticClass:\"close\",attrs:{\"type\":\"button\",\"data-dismiss\":\"alert\",\"aria-label\":\"Close\"}},[_c('span',{attrs:{\"aria-hidden\":\"true\"}},[_vm._v(\"×\")])])}]\nexport { render, staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6bbaa9e2\",\"hasScoped\":false,\"optionsId\":\"0\",\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/Spreadsheet.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}